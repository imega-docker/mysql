services:
  - docker

env:
  global:
    - secure: "JMK0XGkEHRYlymCtj28GEqCJ7XBTw4bpberUvW7O5nD2Njg2AYYx71sOV8pIdbN/cgW27f2OH8mcfTv9PRlYMKhZjjqxB8gcdhIdBNJJUPN1oQYjzR6ZT9aj3eOKC9JB3j1sDMGUjaXLVkZ3qNJGUOkjHcm+5LXZuEnqow5SQWWN1gOjKsyavAPwnE+Zs50dPJ5Wk2xl3zZ94DtC8VF67Tf3Gw6HiPFMm+fZDBninhbH4igQQ7UCiJCFZxWB1gB+yXtYTLczpyYFhE0qFOzv3k7ZxNmq1IzBH3GHO1rSsK0gmppCPLuLABrkEtq/QweRNOtiHf6dh2jga7+AKY6H7SmkxK3HmiueXtLC9ezOuW8+GcqmtxWguIlGhqX1XeTPxO5/iI8oZINdtrSqaBtlY6pLZiAUEk4zNGFDOWxY43T9hqHRxhc7zgfzv2Y/odIhwD1FK24RrsdCm15B952iEYMMVU/w7qyiwfrccPMnvvZrVhYSQLvj0jUL5BnZyYAmmno2hht2cNJkkk7Z78Xj6dlmktcNHx9cjCYqG60wMCjH7I2/qdeZZxGEVKmRKx+kr7HYO7Vcv5s4Bbc8R9RXXBOq6LlE9OFMpN1K+GvrZaD+3fDpUo2pBwNrX4YgCVUr2TPWhulRBEf8Z3vBACgkiiSwKzHCRZwzxzKKwD4lgvA="
    - secure: "FVrP0Tg461N0DAskU2HCHXpbkFqtO5ZUFU0pXcKdbF3sBFMN0MgtRv2xdtUvR4ffm0LzDoANSkdVnDkeVs4NmYbmYHD+vXXp0C35+4o4fjSdMuG74UVOvrYDo1btYTXnr9d5Nvuu5vY/NYurOMKY44911grIfZDKz78gaNlTMX3cENQ1fMMqZgv51P6WipCcq4RHlT85H22pWWix7gZqh5potyO6pQ2lUCKBmeOmUP3ct8pqY1/C8EiP3zybkGJxK+jTW3FZxhMBpd6iPZo4ph4f6ZwuD21ZqIkiJhXCZ4L7Llv9jdia76NtioF2MvawgWB9OfbvfBtzP00NCby+oy35scpNC8dD3vy+03CD1cAx0plLgEJ9mlHp1mQ0c7g8b/qLH9v0BUiZVp2tOzYXsmZK4bNWXUZyXywWynt0XaUKCPxgeAkDY9izjTgq4y4FezjzdC8OBn5v+mmaLYwjqaMazlHPJvh+eVsMH+RDO7VDlmHNZpkmLqq1o+ePLxnvO/G/+V33dCXMhYTzhRY9dL8yd/n/QeHq8PO8hI5Nx/fCioy2sDaIkEDp6yyCM0wopGjOmv4IOJiVqiI2TOPXpVgvQyV2m7G87HdU7osXP5WDsYTT5h2YAMYor8Dw2Hpi79IHvRWTMdiNqZ3IycO/cAFD0h1KMmJduZb6sSk2vtc="
    - secure: "mybe9iI7373v8lfdkDspxFgcieuqngeMMnqJvPzkNn2i9AQlP5IIgkeKvgmJIS2ctJfafq29bCuD7N3JMmW2V0+LUdhbufdN93ksLysPM9+NBI/ukuzXMT/V4HZWjfyKjs4H7tDD68VDujjjiay1JIEiA+5JuBo4fFPiC8aA4N8zrwWiMvIDy0zxR6EbzOXWYTUNReB2FuEZah2gze80LHAcHXiZeFQPQDDqMq4jolYwUqPmblZzL7xizCMjBVP2KRb3rGA41M0+g+sV5LZu0qbjR5stemEsUudCH+Hdzd95IdvOGKoy4DgmppmmIV5ZblsQ92gLzec3HiXDjSIZtu7wpzjFStmptAhpMz9xZaQOMTgFctdCKglwA7kAMUJ1ebzGcFIu2XGlfdcjYAi+GCsLixdLjEiW7zr+iPBb85w3BZqkIkjCG1gNtGINFtjiPEkajXlTUzCfR2gtEhlELAbNDKS6N7xHkt3esCmsyZC9vuAw9THKbStQOuenXHJYhiUD5s74NboKdDo//U0XqJ7vHBy79QJUiLlhC+qjjXIAmnZ9bSasgeW48s5jvjseG41RYvcvZ0ScvsWU6RwMFPAUslN5LnOYDKvJAgcq1cR4Ekuw1iXWeHLlgfOukKxW8Zn/Z3Ebgh2202EUaka3wQ26ynpThrJPkjz/caKKqCE="

script:
  - make build test

after_success:
  - docker login -u $DOCKER_USER -p $DOCKER_PASS
  - docker build -f Dockerfile -t imega/mysql-test .
  - docker push imega/mysql-test